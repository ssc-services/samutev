salt_base="/home/rolszewski/code/git/daimler/vault"
my_ssh_pub_key="ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC6524rp8mMOA9P/JDxTn2OgsQLa9yDXSa5D02lTXIMmLQdEhFejplTdSq5lTAu2Z3sxdQ7+QRlrBWVZrDTVFf6epEIO8hsrKT5B0GGGLVWkrslwyJaubvWeAx8Htd/81CGRHYQSL7x56ZZOOfSJJPklLxp+xQhhbvRB5tId7Uo8jtMR2eOelxbByO9jSxwg1qpYEPucJVHoOfk3KkRIMhj0bVfk/MgVptW982mNJKfCFP40tl9ELAwsC/jrUZlMM7yblifY5IyYwA9j+HJvBJBq8+aqt0k9rYsI1c8oihWz3frYz5pnvVW7VeTO4Li32rasKkA0DWSYHmaU0NYebUb yoursshkey"

# --------------------------------------------------
# --------------------------------------------------
CLOUDINIT_1_header="
#cloud-config
# see docu: https://cloudinit.readthedocs.io/en/latest/topics/examples.html

locale: en_US.UTF-8
keyboard:
  layout: de
  variant: de
apt:
  sources:
    saltrepokey:
      key: |
        -----BEGIN PGP PUBLIC KEY BLOCK-----
        Version: GnuPG v2
        
        mQENBFOpvpgBCADkP656H41i8fpplEEB8IeLhugyC2rTEwwSclb8tQNYtUiGdna9
        m38kb0OS2DDrEdtdQb2hWCnswxaAkUunb2qq18vd3dBvlnI+C4/xu5ksZZkRj+fW
        tArNR18V+2jkwcG26m8AxIrT+m4M6/bgnSfHTBtT5adNfVcTHqiT1JtCbQcXmwVw
        WbqS6v/LhcsBE//SHne4uBCK/GHxZHhQ5jz5h+3vWeV4gvxS3Xu6v1IlIpLDwUts
        kT1DumfynYnnZmWTGc6SYyIFXTPJLtnoWDb9OBdWgZxXfHEcBsKGha+bXO+m2tHA
        gNneN9i5f8oNxo5njrL8jkCckOpNpng18BKXABEBAAG0MlNhbHRTdGFjayBQYWNr
        YWdpbmcgVGVhbSA8cGFja2FnaW5nQHNhbHRzdGFjay5jb20+iQE4BBMBAgAiBQJT
        qb6YAhsDBgsJCAcDAgYVCAIJCgsEFgIDAQIeAQIXgAAKCRAOCKFJ3le/vhkqB/0Q
        WzELZf4d87WApzolLG+zpsJKtt/ueXL1W1KA7JILhXB1uyvVORt8uA9FjmE083o1
        yE66wCya7V8hjNn2lkLXboOUd1UTErlRg1GYbIt++VPscTxHxwpjDGxDB1/fiX2o
        nK5SEpuj4IeIPJVE/uLNAwZyfX8DArLVJ5h8lknwiHlQLGlnOu9ulEAejwAKt9CU
        4oYTszYM4xrbtjB/fR+mPnYh2fBoQO4d/NQiejIEyd9IEEMd/03AJQBuMux62tjA
        /NwvQ9eqNgLw9NisFNHRWtP4jhAOsshv1WW+zPzu3ozoO+lLHixUIz7fqRk38q8Q
        9oNR31KvrkSNrFbA3D89uQENBFOpvpgBCADJ79iH10AfAfpTBEQwa6vzUI3Eltqb
        9aZ0xbZV8V/8pnuU7rqM7Z+nJgldibFk4gFG2bHCG1C5aEH/FmcOMvTKDhJSFQUx
        uhgxttMArXm2c22OSy1hpsnVG68G32Nag/QFEJ++3hNnbyGZpHnPiYgej3FrerQJ
        zv456wIsxRDMvJ1NZQB3twoCqwapC6FJE2hukSdWB5yCYpWlZJXBKzlYz/gwD/Fr
        GL578WrLhKw3UvnJmlpqQaDKwmV2s7MsoZogC6wkHE92kGPG2GmoRD3ALjmCvN1E
        PsIsQGnwpcXsRpYVCoW7e2nW4wUf7IkFZ94yOCmUq6WreWI4NggRcFC5ABEBAAGJ
        AR8EGAECAAkFAlOpvpgCGwwACgkQDgihSd5Xv74/NggA08kEdBkiWWwJZUZEy7cK
        WWcgjnRuOHd4rPeT+vQbOWGu6x4bxuVf9aTiYkf7ZjVF2lPn97EXOEGFWPZeZbH4
        vdRFH9jMtP+rrLt6+3c9j0M8SIJYwBL1+CNpEC/BuHj/Ra/cmnG5ZNhYebm76h5f
        T9iPW9fFww36FzFka4VPlvA4oB7ebBtquFg3sdQNU/MmTVV4jPFWXxh4oRDDR+8N
        1bcPnbB11b5ary99F/mqr7RgQ+YFF0uKRE3SKa7a+6cIuHEZ7Za+zhPaQlzAOZlx
        fuBmScum8uQTrEF5+Um5zkwC7EXTdH1co/+/V/fpOtxIg4XO4kcugZefVm5ERfVS
        MA==
        =dtMN
        -----END PGP PUBLIC KEY BLOCK-----
    salt.list:
      source: |
        deb [ arch=amd64 ] http://repo.saltstack.com/py3/ubuntu/20.04/amd64/3001 focal main
  geoip: false
package_update: true
package_upgrade: false
"

# --------------------------------------------------
CLOUDINIT_2_master="
packages:
  - salt-master

write_files:
- content: |
      fileserver_backend:
      - roots
      file_roots:
        base:
          - /srv/salt/salt-states
          - /srv/salt/localstore
      pillar_roots:
        base:
          - /srv/salt/salt-dev-pillars
          - /srv/salt/salt-pillars
  path: /etc/salt/master.d/master.conf
"

CLOUDINIT_2_masterless="
packages:
  - salt-minion

write_files:
- content: |
      file_client: local
      fileserver_backend:
      - roots
      file_roots:
        base:
          - /srv/salt/salt-states
          - /srv/salt/localstore
      pillar_roots:
        base:
          - /srv/salt/salt-dev-pillars
          - /srv/salt/salt-pillars
  path: /etc/salt/minion.d/masterless_minion.conf
"

# --------------------------------------------------
CLOUDINIT_2_minion="
packages:
  - salt-minion

write_files:
- content: |
      master: xxxIPxxx
  path: /etc/salt/minion.d/master.conf

"

# --------------------------------------------------
CLOUDINIT_3_user="
# Add groups to the system
# The following example adds the ubuntu group with members 'root' and 'sys'
# and the empty group cloud-users.
#groups:
#  - ubuntu: [root,sys]
#  - cloud-users

# Add users to the system. Users are added after groups are added.
# Note: Most of these configuration options will not be honored if the user
#       already exists. Following options are the exceptions and they are
#       applicable on already-existing users:
#       - 'plain_text_passwd', 'hashed_passwd', 'lock_passwd', 'sudo',
#         'ssh_authorized_keys', 'ssh_redirect_user'.
users:
  - default
  - name: user
    gecos: normal user with sudo right and ssh authorized keys
    primary_group: user
    groups: users, admin
    sudo: ALL=(ALL) NOPASSWD:ALL
    lock_passwd: false
    shell: /bin/bash
    ssh_authorized_keys:
        - $my_ssh_pub_key
#    passwd: $6$NWGpZNw9T/.TLMhV$94IRUaP8nnhtb8iIhmAxd3FkhqirJU4JKOsSzSlIJglSMPFfRo6s7YqEYsI1HTbzXU.s3jY2DeiCyVERAnYUY/
  - name: root
    ssh_authorized_keys:
        - $my_ssh_pub_key
"

# --------------------------------------------------
DEVPILLARS_top="
base:
  '*':
    - devpillars
"

# --------------------------------------------------
DEVPILLARS="
test:
  pillar:
    key: "testvalue"
"

# --------------------------------------------------
